<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimizing Static Parameters · Gen</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Gen</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../getting_started/">Getting Started</a></li><li><a class="toctext" href="../../tutorials/">Tutorials</a></li><li><a class="toctext" href="../../guide/">Guide</a></li><li><span class="toctext">Language and API Reference</span><ul><li><a class="toctext" href="../modeling/">Built-in Modeling Language</a></li><li><a class="toctext" href="../combinators/">Generative Function Combinators</a></li><li><a class="toctext" href="../assignments/">Assignments</a></li><li><a class="toctext" href="../selections/">Selections</a></li><li class="current"><a class="toctext" href>Optimizing Static Parameters</a><ul class="internal"></ul></li><li><a class="toctext" href="../inference/">Inference Library</a></li><li><a class="toctext" href="../gfi/">Generative Function Interface</a></li><li><a class="toctext" href="../distributions/">Probability Distributions</a></li></ul></li><li><span class="toctext">Internals</span><ul><li><a class="toctext" href="../internals/parameter_optimization/">Optimizing Static Parameters</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Language and API Reference</li><li><a href>Optimizing Static Parameters</a></li></ul><a class="edit-page" href="https://github.com/probcomp/Gen/blob/master/docs/src/ref/parameter_optimization.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Optimizing Static Parameters</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Optimizing-Static-Parameters-1" href="#Optimizing-Static-Parameters-1">Optimizing Static Parameters</a></h1><p>Gradient-based optimization of the static parameters of generative functions is based on interleaving (1) accumulation of gradients with respect to static parameters using <code>backprop_params</code> with (2) updates to the static parameters that read from the gradients, mutate the value of the static parameters, and reset the gradients to zero.</p><p>Gen has built-in support for the following configuration types of updates:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Gen.GradientDescent" href="#Gen.GradientDescent"><code>Gen.GradientDescent</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">conf = GradientDescent(step_size_init, step_size_beta)</code></pre><p>Configuration for stochastic gradient descent update with step size given by <code>(t::Int) -&gt; step_size_init * (step_size_beta + 1) / (step_size_beta + t)</code> where <code>t</code> is the iteration number.</p></div></div><a class="source-link" target="_blank" href="https://github.com/probcomp/Gen/blob/6b0a12aaa422002dfaeab04de9f758ac5dbf9eb7/src/optimization.jl#L75-L79">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Gen.ADAM" href="#Gen.ADAM"><code>Gen.ADAM</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">conf = ADAM(learning_rate, beta1, beta2)</code></pre><p>Configuration for ADAM update.</p></div></div><a class="source-link" target="_blank" href="https://github.com/probcomp/Gen/blob/6b0a12aaa422002dfaeab04de9f758ac5dbf9eb7/src/optimization.jl#L85-L89">source</a></section><p>Parameter updates are constructed by combining a configuration value with the set of static parameters that it should be applied to:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Gen.ParamUpdate" href="#Gen.ParamUpdate"><code>Gen.ParamUpdate</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">update = ParamUpdate(conf, param_lists...)</code></pre><p>Return an update configured by <code>conf</code> that applies to set of parameters defined by <code>param_lists</code>.</p><p>Each element in <code>param_lists</code> value is is pair of a generative function and a vector of its parameter references.</p><p><strong>Example</strong>. To construct an update that applies a gradient descent update to the parameters <code>:a</code> and <code>:b</code> of generative function <code>foo</code> and the parameter <code>:theta</code> of generative function <code>:bar</code>:</p><pre><code class="language-julia">update = ParamUpdate(GradientDescent(0.001, 100), foo =&gt; [:a, :b], bar =&gt; [:theta])</code></pre><hr/><pre><code class="language-none">update = ParamUpdate(conf, gen_fn::GenerativeFunction)</code></pre><p>Return an update configured by <code>conf</code> that applies to all trainable parameters owned by the given generative function.</p><p>Note that trainable parameters not owned by the given generative function will not be updated, even if they are used during execution of the function. This is syntactic sugar for the constructor form above.</p><p><strong>Example</strong>. If generative function <code>foo</code> has parameters <code>:a</code> and <code>:b</code>, to construct an update that applies a gradient descent update to the parameters <code>:a</code> and <code>:b</code>:</p><pre><code class="language-julia">update = ParamUpdate(GradientDescent(0.001, 100), foo)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/probcomp/Gen/blob/6b0a12aaa422002dfaeab04de9f758ac5dbf9eb7/src/optimization.jl#L18-L45">source</a></section><p>Finally, an update is applied with:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Gen.apply!" href="#Gen.apply!"><code>Gen.apply!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">apply!(update::ParamUpdate)</code></pre><p>Perform one step of the update.</p></div></div><a class="source-link" target="_blank" href="https://github.com/probcomp/Gen/blob/6b0a12aaa422002dfaeab04de9f758ac5dbf9eb7/src/optimization.jl#L63-L67">source</a></section><footer><hr/><a class="previous" href="../selections/"><span class="direction">Previous</span><span class="title">Selections</span></a><a class="next" href="../inference/"><span class="direction">Next</span><span class="title">Inference Library</span></a></footer></article></body></html>
